var e=require("path"),o=require("electron"),t=require("puppeteer"),a=require("cheerio"),n=require("lodash"),r=require("os");function i(e){return e&&e.__esModule?e.default:e}let l=[],c="";const s=i(r).userInfo();switch(i(r).platform()){case"win32":c="C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe";break;case"linux":c=`/home/${s.username}/.cache/puppeteer/chrome/linux-132.0.6834.110/chrome-linux64/chrome`}const d=async e=>{let o=await t.launch({executablePath:c}),r=await o.newPage();await r.setViewport({width:1920,height:1080});try{await r.goto(`https://www.bcb.gov.br/estatisticas/reporttxjuroshistorico?historicotaxajurosdiario_page=1&codigoSegmento=1&codigoModalidade=${e.codModalidade}&tipoModalidade=D&InicioPeriodo=${e.periodo}`),await r.waitForSelector("table.table tbody",{timeout:1e4});let o=await r.content();if(o){let e=a.load(o),t=[];e("table").find("tbody > tr").each((o,a)=>{e(a).find("> td").each((o,a)=>{let n=e(a).text();t.push(n.replace(" ",""))})}),t.length>0?(0,n.chunk)(t,4).forEach(e=>{l?.push({position:e[0],bankName:e[1],monthlyRate:e[2],annualRate:e[3]})}):console.log("Falha ao buscar os dados, tente novamente.")}}catch(e){console.log(e)}await o.close()};var h=async e=>{await d(e);let o=0,t=0;return Object.keys(l).forEach((e,t)=>{let a=parseFloat(l[t].monthlyRate.replace(",","."));o+=a}),t=Math.floor(o/l.length*100)/100,console.log({total:o,numeroDeBancos:l.length,media:t}),l=[],Math.floor(100*t)/100},u=e.resolve(__dirname,"../src");const p=i(e).join(u,"../_electron/"),w=()=>{let e=new o.BrowserWindow({width:1280,height:720,maximizable:!0,center:!0,icon:"../images/logo.ico",roundedCorners:!0,webPreferences:{preload:p+"preload.js"}}),t=(0,o.Menu).buildFromTemplate([{label:"BCB Interest Check",submenu:[{click:()=>e.webContents.send("update-counter",1),label:"Increment"},{click:()=>e.webContents.send("update-counter",-1),label:"Decrement"}]}]);(0,o.Menu).setApplicationMenu(t),e.loadFile(p+"static/index.html"),e.webContents.openDevTools()};(0,o.app).whenReady().then(()=>{(0,o.ipcMain).handle("fetchBCB",async(e,o)=>{let t=await h(o);if(t)return t;throw Error("Falha ao buscar os dados no Banco Central.")}),(0,o.ipcMain).on("counter-value",(e,o)=>{console.log(o)}),w(),(0,o.app).on("activate",()=>{0===(0,o.BrowserWindow).getAllWindows().length&&w()})}),(0,o.app).on("window-all-closed",()=>{"darwin"!==process.platform&&(0,o.app).quit()});
//# sourceMappingURL=main.js.map
